<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin — Sport in a Box</title>
  <link rel="stylesheet" href="../styles.css" />

  <style>
    /* Admin app layout (glassy, Apple-like) */
    .admin-app { min-height: 100vh; }
    .admin-shell{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 18px;
      padding: 18px;
      max-width: 1200px;
      margin: 0 auto;
    }
    @media (max-width: 980px){
      .admin-shell{ grid-template-columns: 1fr; }
    }

    .admin-side{
      position: sticky;
      top: 18px;
      align-self: start;
      padding: 14px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.04);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
    }
    .admin-brand{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom: 12px; }
    .admin-brand h1{ font-size: 14px; letter-spacing: .2px; margin:0; color: rgba(255,255,255,.9); }
    .admin-user{ font-size: 12px; color: rgba(255,255,255,.62); }

    .admin-nav{ display:grid; gap: 8px; margin-top: 12px; }
    .admin-nav a{
      display:flex; align-items:center; justify-content:space-between;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      color: rgba(255,255,255,0.84);
      text-decoration:none;
      transition: transform .14s ease, background .14s ease;
    }
    .admin-nav a:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.06); }
    .admin-nav a.is-active{ background: rgba(255,255,255,0.09); border-color: rgba(255,255,255,0.16); }

    .admin-main{
      padding: 14px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.04);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
    }

    .admin-toprow{ display:flex; align-items:flex-end; justify-content:space-between; gap: 12px; margin-bottom: 12px; }
    .admin-title{ margin:0; font-size: 18px; color: rgba(255,255,255,.92); }
    .admin-sub{ margin:0; font-size: 12.5px; color: rgba(255,255,255,.62); }

    .admin-actions{ display:flex; gap: 10px; flex-wrap: wrap; justify-content:flex-end; }

    /* Products toolbar */
    .admin-toolbar{ display:flex; gap: 10px; flex-wrap: wrap; align-items:center; justify-content:space-between; margin-top: 12px; }
    .admin-toolbar .left{ display:flex; gap: 10px; flex-wrap: wrap; align-items:center; }
    .admin-search{
      width: min(520px, 100%);
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.03);
      color: rgba(255,255,255,0.88);
      outline: none;
    }
    .segmented{ display:inline-flex; gap: 6px; padding: 6px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.10); background: rgba(0,0,0,0.18); }
    .segmented button{ border: 0; background: transparent; color: rgba(255,255,255,0.80); padding: 8px 10px; border-radius: 999px; cursor:pointer; font-size: 12px; }
    .segmented button.is-active{ background: rgba(255,255,255,0.10); color: rgba(255,255,255,0.92); }

    /* Editor enhancements */
    .editor-split{ display:grid; grid-template-columns: 1.1fr .9fr; gap: 14px; margin-top: 12px; }
    @media (max-width: 980px){ .editor-split{ grid-template-columns: 1fr; } }
    .editor-preview{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.18);
      padding: 14px;
      position: sticky;
      top: 18px;
      align-self: start;
    }
    .preview-card{ border-radius: 18px; overflow:hidden; border: 1px solid rgba(255,255,255,0.10); background: rgba(255,255,255,0.03); }
    .preview-img{ width:100%; height: 220px; object-fit: cover; display:block; background: rgba(255,255,255,0.03); }
    .preview-body{ padding: 12px; }
    .preview-name{ margin:0; font-size: 14.5px; color: rgba(255,255,255,0.92); }
    .preview-meta{ margin:6px 0 0; font-size: 12px; color: rgba(255,255,255,0.62); }
    .preview-price{ margin: 10px 0 0; font-size: 16px; font-weight: 750; color: rgba(255,255,255,0.94); }
    .preview-desc{ margin: 10px 0 0; font-size: 12.5px; color: rgba(255,255,255,0.78); line-height: 1.4; }

    .dropzone{
      border-radius: 18px;
      border: 1px dashed rgba(255,255,255,0.22);
      background: rgba(255,255,255,0.02);
      padding: 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      transition: background .14s ease, border-color .14s ease;
    }
    .dropzone.is-dragover{ background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.34); }
    .dz-title{ margin:0; font-size: 12.5px; color: rgba(255,255,255,0.86); }
    .dz-sub{ margin:4px 0 0; font-size: 12px; color: rgba(255,255,255,0.62); }
    .dz-actions{ display:flex; gap: 8px; flex-wrap: wrap; justify-content:flex-end; }
    .errorline{ margin-top: 8px; font-size: 12px; color: rgba(255,120,120,0.95); }
    .field.is-invalid input, .field.is-invalid textarea, .field.is-invalid select{ border-color: rgba(255,120,120,0.40); background: rgba(255,120,120,0.05); }

    .admin-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      margin-top: 12px;
    }
    @media (max-width: 980px){ .admin-grid{ grid-template-columns: 1fr; } }

    .panel{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.18);
      padding: 14px;
    }
    .panel h3{ margin:0 0 10px; font-size: 13.5px; color: rgba(255,255,255,.90); }
    .muted{ color: rgba(255,255,255,.62); }

    .row{ display:flex; gap: 10px; flex-wrap: wrap; }
    .row > *{ flex: 1; min-width: 200px; }

    .field label{ display:block; font-size:12px; color: rgba(255,255,255,.66); margin-bottom: 6px; }
    .field input, .field textarea, .field select{
      width: 100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.03);
      color: rgba(255,255,255,0.88);
      outline: none;
    }
    .field textarea{ min-height: 110px; resize: vertical; }

    .pillbar{ display:flex; gap: 8px; flex-wrap: wrap; }
    .pillbtn{
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.03);
      color: rgba(255,255,255,0.84);
      cursor:pointer;
      font-size: 12px;
      transition: transform .14s ease, background .14s ease;
    }
    .pillbtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.06); }
    .pillbtn.is-active{ background: rgba(255,255,255,0.10); border-color: rgba(255,255,255,0.16); }

    .table{ width: 100%; border-collapse: collapse; overflow:hidden; border-radius: 16px; }
    .table th, .table td{ text-align:left; padding: 10px 10px; border-bottom: 1px solid rgba(255,255,255,0.08); font-size: 12.5px; }
    .table th{ color: rgba(255,255,255,.70); font-weight: 650; }
    .table td{ color: rgba(255,255,255,.86); }
    .tag{ display:inline-flex; padding: 4px 8px; border-radius: 999px; border:1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.03); font-size: 11.5px; }
    .tag.published{ background: rgba(120,255,180,0.10); border-color: rgba(120,255,180,0.18); }
    .tag.draft{ background: rgba(255,255,255,0.04); }

    .imggrid{ display:grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    @media (max-width: 980px){ .imggrid{ grid-template-columns: repeat(3, 1fr);} }
    @media (max-width: 560px){ .imggrid{ grid-template-columns: repeat(2, 1fr);} }

    .imgcard{
      border-radius: 16px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.20);
      position: relative;
    }
    .imgcard img{ width:100%; height: 110px; object-fit: cover; display:block; }
    .imgcard .imgactions{
      position:absolute; inset: 8px 8px auto auto;
      display:flex; gap: 6px;
    }
    .iconbtn{
      width: 32px; height: 32px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.30);
      color: rgba(255,255,255,0.90);
      cursor:pointer;
    }

    .login-wrap{
      max-width: 520px;
      margin: 48px auto;
      padding: 18px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.04);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
    }

    .state--hidden{ display:none !important; }

    /* reuse your global toast */
    .global-toast {
      position: fixed;
      right: 18px;
      bottom: 18px;
      z-index: 9999;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.30);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      color: rgba(255,255,255,0.88);
      font-size: 13px;
      box-shadow: 0 16px 48px rgba(0,0,0,0.35);
      opacity: 0;
      transform: translateY(6px);
      pointer-events: none;
      transition: opacity .16s ease, transform .16s ease;
    }
    .global-toast.is-visible{ opacity: 1; transform: translateY(0px); }
  </style>

  <script defer src="./admin.js"></script>
</head>

<body class="admin-app">
  <!-- LOGIN -->
  <main id="loginView" class="login-wrap state--hidden">
    <h1 class="admin-title">Admin</h1>
    <p class="admin-sub">Log in om producten te beheren.</p>

    <div class="row" style="margin-top:12px;">
      <div class="field">
        <label>Email</label>
        <input id="loginEmail" type="email" placeholder="admin@..." autocomplete="username" />
      </div>
      <div class="field">
        <label>Password</label>
        <input id="loginPassword" type="password" placeholder="••••••••" autocomplete="current-password" />
      </div>
    </div>

    <div class="admin-actions" style="margin-top:12px;">
      <button id="loginBtn" class="pillbtn" type="button">Login</button>
    </div>
  </main>

  <!-- APP -->
  <main id="appView" class="admin-shell state--hidden">
    <aside class="admin-side">
      <div class="admin-brand">
        <h1>Sport in a Box</h1>
        <button id="logoutBtn" class="pillbtn" type="button">Logout</button>
      </div>
      <div class="admin-user" id="meLabel">—</div>

      <nav class="admin-nav" style="margin-top:12px;">
        <a href="#products" id="navProducts">Products <span class="tag" id="navCount">—</span></a>
        <a href="#analytics" id="navAnalytics">Analytics</a>
        <a href="#settings" id="navSettings">Settings</a>
      </nav>
    </aside>

    <section class="admin-main">
      <!-- PRODUCTS -->
      <div id="viewProducts" class="state--hidden">
        <div class="admin-toprow">
          <div>
            <h2 class="admin-title">Products</h2>
            <p class="admin-sub">Beheer je live catalogus (draft/published) en images.</p>
          </div>
          <div class="admin-actions">
            <button id="newProductBtn" class="pillbtn" type="button">New product</button>
            <button id="refreshBtn" class="pillbtn" type="button">Refresh</button>
          </div>
        </div>

        <div class="admin-toolbar">
          <div class="left">
            <input id="productsSearch" class="admin-search" type="search" placeholder="Search by name, slug, category…" />
            <div class="segmented" role="tablist" aria-label="Status filter">
              <button id="filterAll" class="is-active" type="button">All</button>
              <button id="filterPublished" type="button">Published</button>
              <button id="filterDraft" type="button">Draft</button>
            </div>
          </div>
          <div class="admin-actions">
            <button id="quickPublishBtn" class="pillbtn" type="button">Publish/Unpublish</button>
            <button id="duplicateBtn" class="pillbtn" type="button">Duplicate</button>
          </div>
        </div>

        <div class="panel">
          <table class="table">
            <thead>
              <tr>
                <th style="width:34px;"><input id="selectAll" type="checkbox" aria-label="Select all" /></th>
                <th style="width:36%;">Name</th>
                <th>Slug</th>
                <th>Category</th>
                <th>Status</th>
                <th style="width:16%;">Price</th>
                <th style="width:14%;">Actions</th>
              </tr>
            </thead>
            <tbody id="productsTbody"></tbody>
          </table>
          <p class="muted" id="productsState" style="margin:10px 0 0;">—</p>
        </div>

        <!-- EDITOR -->
        <div id="editorWrap" class="panel state--hidden" style="margin-top:14px;">
          <div class="admin-toprow" style="margin-bottom:10px;">
            <div>
              <h3 id="editorTitle">New product</h3>
              <p class="admin-sub" id="editorSub">Werk in secties. Opslaan = naar D1.</p>
            </div>
            <div class="admin-actions">
              <button id="cancelEditBtn" class="pillbtn" type="button">Close</button>
              <button id="saveBtn" class="pillbtn" type="button">Save</button>
            </div>
          </div>

          <div id="formErrors" class="errorline state--hidden"></div>

          <div class="pillbar" style="margin-bottom:12px;">
            <button class="pillbtn is-active" data-tab="core" type="button">Core</button>
            <button class="pillbtn" data-tab="content" type="button">Content</button>
            <button class="pillbtn" data-tab="images" type="button">Images</button>
            <button class="pillbtn" data-tab="specs" type="button">Specs</button>
            <button class="pillbtn" data-tab="publish" type="button">Publish</button>
          </div>

          <div class="editor-split">
            <div>
              <div class="admin-grid">
                <!-- CORE -->
                <div class="panel" id="tab_core">
              <h3>Core</h3>
              <div class="row">
                <div class="field">
                  <label>Name</label>
                  <input id="fName" type="text" placeholder="Sport in a Box — Basic" />
                </div>
                <div class="field">
                  <label>Slug (auto)</label>
                  <input id="fSlug" type="text" placeholder="sport-in-a-box-basic" />
                      <div id="slugError" class="errorline state--hidden">Slug is al in gebruik.</div>
                </div>
              </div>

              <div class="row" style="margin-top:10px;">
                <div class="field">
                  <label>Category</label>
                  <input id="fCategory" type="text" placeholder="hygiene" list="categoryList" />
                  <datalist id="categoryList"></datalist>
                </div>
                <div class="field">
                  <label>Currency</label>
                  <input id="fCurrency" type="text" value="EUR" />
                </div>
              </div>

              <div class="row" style="margin-top:10px;">
                <div class="field">
                  <label>Price (EUR)</label>
                  <input id="fPrice" type="text" placeholder="29,99" />
                </div>
              </div>

              <p class="muted" style="margin:10px 0 0;">Tip: prijs invoeren als 29,99 — wij converteren naar cents.</p>
            </div>

                <!-- CONTENT -->
                <div class="panel" id="tab_content">
              <h3>Content</h3>
              <div class="field">
                <label>Description</label>
                <textarea id="fDescription" placeholder="Korte, strakke omschrijving."></textarea>
              </div>

              <div class="field" style="margin-top:10px;">
                <label>Highlights (1 per regel)</label>
                <textarea id="fHighlights" placeholder="Premium kwaliteit&#10;Snelle levering&#10;Audit-proof"></textarea>
              </div>
            </div>

                <!-- IMAGES -->
                <div class="panel" id="tab_images">
              <h3>Images</h3>

                  <div id="dropzone" class="dropzone" tabindex="0" role="button" aria-label="Upload images">
                    <div>
                      <p class="dz-title">Sleep images hierheen</p>
                      <p class="dz-sub">of kies bestanden — we uploaden en voegen ze direct toe aan je product.</p>
                    </div>
                    <div class="dz-actions">
                      <input id="fImageFiles" type="file" accept="image/*" multiple class="state--hidden" />
                      <button id="pickImagesBtn" class="pillbtn" type="button">Choose files</button>
                      <button id="uploadImagesBtn" class="pillbtn" type="button">Upload</button>
                    </div>
                  </div>

              <p class="muted" id="uploadState" style="margin:10px 0 0;">—</p>
              <div id="imageGrid" class="imggrid" style="margin-top:12px;"></div>
            </div>

                <!-- SPECS -->
                <div class="panel" id="tab_specs">
              <h3>Specs</h3>
              <div class="field">
                <label>Specs editor (key/value)</label>
                <textarea id="fSpecsJson" placeholder='{"maat":"M","kleur":"zwart"}'></textarea>
              </div>
              <p class="muted" id="specsHint" style="margin:10px 0 0;">We valideren JSON en tonen errors direct.</p>
            </div>

                <!-- PUBLISH -->
                <div class="panel" id="tab_publish">
              <h3>Publish</h3>
              <div class="row">
                <div class="field">
                  <label>Status</label>
                  <select id="fStatus">
                    <option value="draft">draft</option>
                    <option value="published">published</option>
                  </select>
                </div>
              </div>

              <p class="muted" style="margin:10px 0 0;">
                Alleen <b>published</b> is zichtbaar op de publieke webshop.
              </p>
            </div>
              </div>
            </div>

            <aside class="editor-preview" aria-label="Live preview">
              <div class="preview-card">
                <img id="previewImg" class="preview-img" alt="" />
                <div class="preview-body">
                  <p class="preview-meta" id="previewStatus">draft</p>
                  <h4 class="preview-name" id="previewName">—</h4>
                  <p class="preview-meta" id="previewMeta">—</p>
                  <div class="preview-price" id="previewPrice">€ —</div>
                  <p class="preview-desc" id="previewDesc">—</p>
                </div>
              </div>
              <p class="muted" style="margin:10px 0 0;">Tip: sleep images om te herordenen. Eerste image = cover.</p>
            </aside>
          </div>
        </div>
      </div>

      <!-- ANALYTICS -->
      <div id="viewAnalytics" class="state--hidden">
        <div class="admin-toprow">
          <div>
            <h2 class="admin-title">Analytics</h2>
            <p class="admin-sub">Hier komt je site analytics dashboard.</p>
          </div>
        </div>

        <div class="panel">
          <h3>Coming soon</h3>
          <p class="muted">
            Volgende stap: integratie met Cloudflare Web Analytics of custom events via je Worker.
          </p>
        </div>
      </div>

      <!-- SETTINGS -->
      <div id="viewSettings" class="state--hidden">
        <div class="admin-toprow">
          <div>
            <h2 class="admin-title">Settings</h2>
            <p class="admin-sub">Admin settings (later uitbreiden).</p>
          </div>
        </div>

        <div class="panel">
          <h3>Session</h3>
          <p class="muted">Je bent ingelogd met JWT. Logout wist je token uit localStorage.</p>
        </div>
      </div>
    </section>
  </main>

  <div id="globalToast" class="global-toast" aria-live="polite" aria-atomic="true"></div>
</body>
</html>
